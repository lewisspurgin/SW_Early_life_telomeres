---
output:
  word_document:
    reference_docx: myref.docx
---

###Supplementary information for Spurgin *et al.* "Telomeres reveal silver spoon effects in a wild population"





```{r setup, include = F}

rm(list=ls())

#Load knitr
library(knitr) 

#Set some options
options(na.action='na.fail')
opts_knit$set(root.dir = '..')
opts_chunk$set(echo=FALSE,
               warning=FALSE,
               message=FALSE,
               fig.path='../Figures/',
               fig.width= 5,
               fig.height= 5,
               fig.show='asis',
               dev=c('png'))

```

```{r load and clean, include = F}

#Load and clean data
source('Scripts/SW juvenile telomeres IPC load.r')
source('Scripts/SW juvenile telomeres IPC functions.r')
source('Scripts/SW juvenile telomeres IPC clean.r')


```

**Table S1** Model selection table for analysis of factors affecting early life telomere length in juvenile Seychelles warblers. Only models that remained in the top model set for model averaging (AICc $\leq$ 6 compared to the top model) are included here. TQ = territory quality.

```{r Table S1}

temp <- subset(juv,!is.na(cenTQ))

#Run the model
lm1 <- lmer(RTL ~ Agemonths * (Tarsus + Helper + NonHelper + Sex + BodyMass  + cenTQ) + (1|BirdID)+(1|FieldPeriodID)+(1|TerritoryID),
            data = temp,
            REML = FALSE)
lm1 <- standardize(lm1)

#Model averaging
lm2 <- dredge(lm1)
t1 <- as.matrix(subset(lm2, delta<=6))

#Sort out row/col names
nams <- colnames(t1)

nams[nams == 'z.NonHelper'] <- 'Non helpers'
nams[nams == 'c.Sex'] <- 'Sex'
nams[nams == 'z.TQ'] <- 'TQ'
nams[nams == 'c.Helper'] <- 'Helpers'
nams[nams == 'z.BodyMass'] <- 'Body mass'
nams[nams == 'z.Agemonths'] <- 'Age'
nams[nams == 'z.Tarsus'] <- 'Tarsus'
nams[nams == 'c.Season'] <- 'Season'
nams[nams == 'c.Season:z.Agemonths'] <- 'Age x season'
nams[nams == 'z.Agemonths:z.NonHelper'] <- 'Age x non helpers'
nams[nams == 'c.Sex:z.Agemonths'] <- 'Age x sex'
nams[nams == 'z.Agemonths:z.TQ'] <- 'Age x TQ'
nams[nams == 'c.Helper:z.Agemonths'] <- 'Age x helpers'
nams[nams == 'z.Agemonths:z.BodyMass'] <- 'Age x mass'
nams[nams == 'z.Agemonths:z.Tarsus'] <- 'Age x tarsus'


colnames(t1) <- nams

tableS1 <- data.frame(Model = apply(t1,1,getterms,c(2:14)),t1[,c('df','AICc','delta','weight')],stringsAsFactors = FALSE)
colnames(tableS1) <- c('Model','df','AICc', 'Delta AICc','Weight')
rownames(tableS1) <- NULL
tableS1$Model[tableS1$Model == ''] <- 'Null model'
tableS1[,3:5] <- lapply(tableS1[,3:5],as.numeric)
kable(tableS1,digits=2)

```




**Table S2** Model selection table for analysis of factors affecting $\Delta$RTL in Seychelles warbler nestlings, using longitudinal data. Only models that remained in the top model set for model averaging (AICc $\leq$ 6 compared to the top model) are included here. TQ = territory quality.

```{r Table S2}
temp <- dd3
temp <- subset(temp,!is.na(TQ))

#Run the model
lm1 <- lmer(DeltaRTL ~ Agemonths+(DeltaCondition + Sex + TQ) + (1|BirdID) + (1|FieldPeriodID) + (1|TerritoryID),
            data = temp,
            REML = FALSE)

lm1 <- glmer(DeltaRTLF ~ Agemonths+(Tarsus + Helper + Sex + BodyMass +TQ) + (1|TerritoryID) + (1|BirdID),
            data = temp,
            family = 'binomial',
            control = glmerControl(optimizer = 'bobyqa'))

lm1 <- standardize(lm1)
summary(lm1)
confint.merMod(lm1)

#Model averaging
lm2 <- dredge(lm1)
t1 <- as.matrix(subset(lm2, delta<=6))

#Sort out row/col names
nams <- colnames(t1)

nams[nams == 'z.NonHelper'] <- 'Non helpers'
nams[nams == 'c.Sex'] <- 'Sex'
nams[nams == 'z.TQ'] <- 'TQ'
nams[nams == 'c.Helper'] <- 'Helpers'
nams[nams == 'z.BodyMass'] <- 'Body mass'
nams[nams == 'z.Agemonths'] <- 'Age'
nams[nams == 'z.Tarsus'] <- 'Tarsus'
nams[nams == 'c.Season'] <- 'Season'
nams[nams == 'c.Season:z.Agemonths'] <- 'Age x season'
nams[nams == 'z.Agemonths:z.NonHelper'] <- 'Age x non helpers'
nams[nams == 'c.Sex:z.Agemonths'] <- 'Age x sex'
nams[nams == 'z.Agemonths:z.TQ'] <- 'Age x TQ'
nams[nams == 'c.Helper:z.Agemonths'] <- 'Age x helpers'
nams[nams == 'z.Agemonths:z.BodyMass'] <- 'Age x mass'
nams[nams == 'z.Agemonths:z.Tarsus'] <- 'Age x tarsus'


colnames(t1) <- nams

tableS1 <- data.frame(Model = apply(t1,1,getterms,c(2:14)),t1[,c('df','AICc','delta','weight')],stringsAsFactors = FALSE)
colnames(tableS1) <- c('Model','df','AICc', 'Delta AICc','Weight')
rownames(tableS1) <- NULL
tableS1$Model[tableS1$Model == ''] <- 'Null model'
tableS1[,3:5] <- lapply(tableS1[,3:5],as.numeric)
kable(tableS1,digits=2)

```

ggplot(dd3,aes(x = DeltaMass,y = (DeltaRTL)))+
geom_point()+
stat_smooth(method = 'lm')



**Figure S1** $\Delta$RTL in relation to the time between sampling events. Lines and shaded areas represent fitted values and 95% confidence limits from general linear models. See also Figure 4, main text.


```{r Figure S1}

temp <- Loss
temp[,'Age (months)'] <- factor(temp$Agemonths)
temp$LayYear <- factor(temp$LayYear)
temp$TimeDiff <- temp$TimeDiff/365


FigS1 <- ggplot(temp,
       aes(x = TimeDiff,
           y = Loss,
           colour=`Age (months)`,
           fill = `Age (months)`)) +
  ylab(expression(Delta*'RTL')) + 
  xlab('Time (years)') +
  theme_classic() +
  theme(axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12), 
        axis.title.y = element_text(size = 14,vjust=0.8),
        axis.title.x = element_text(size = 14),
        legend.position = 'top') +
  geom_point()+
  stat_smooth(method = 'lm')+
  scale_colour_manual(values = c('grey','darkorange','darkgreen'))+
  scale_fill_manual(values = c('grey','darkorange','darkgreen'))+
    geom_abline(slope = 0,intercept = 0,lty = 2)+
  annotate('text',x = 0,y = 1.75,label = 'B')

FigS1

```