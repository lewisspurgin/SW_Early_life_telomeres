---
output:
  word_document:
    reference_docx: myref.docx
---

###Supplementary information for Spurgin *et al.* "Telomeres reveal silver spoon effects in a wild population"





```{r setup, include = F}

rm(list=ls())

#Load knitr
library(knitr) 

#Set some options
options(na.action='na.fail')
opts_knit$set(root.dir = '..')
opts_chunk$set(echo=FALSE,
               warning=FALSE,
               message=FALSE,
               fig.path='../Figures/',
               fig.width= 5,
               fig.height= 5,
               fig.show='asis',
               dev=c('png'))

```

```{r load and clean, include = F}

#Load and clean data
source('Scripts/SW juvenile telomeres IPC load.r')
source('Scripts/SW juvenile telomeres IPC functions.r')
source('Scripts/SW juvenile telomeres IPC clean.r')
source('Scripts/SW juvenile telomeres IPC models.r')
source('Scripts/SW juvenile telomeres IPC model averaging.r')

```

**Table S1** Model selection table for analysis of factors affecting early life telomere length in juvenile Seychelles warblers. Only models that remained in the top model set for model averaging (AICc $\leq$ 6 compared to the top model) are included here.

```{r Table S1}


#Model averaging

t1 <- as.matrix(RTL_Full_Dredge)

#Sort out row/col names
nams <- colnames(t1)

nams[nams == 'z.GroupSize'] <- 'Group Size'
nams[nams == 'c.Sex'] <- 'Sex (males)'
nams[nams == 'c.Helper'] <- 'Helpers'
nams[nams == 'z.BodyMass'] <- 'Body mass'
nams[nams == 'z.LogAge'] <- 'Log age'
nams[nams == 'z.Tarsus'] <- 'Tarsus'
nams[nams == 'z.Insect'] <- 'Insect abundance'
nams[nams == 'z.CatchMonth'] <- 'Month'
nams[nams == 'z.Density'] <- 'Density'
nams[nams == 'z.TQ'] <- 'Territory quality'


colnames(t1) <- nams

tableS1 <- data.frame(Model = apply(t1,1,getterms,c(2:10)),t1[,c('df','AICc','delta','weight')],stringsAsFactors = FALSE)
colnames(tableS1) <- c('Model','df','AICc', 'Delta AICc','Weight')
rownames(tableS1) <- NULL
tableS1$Model[tableS1$Model == ''] <- 'Null model'
tableS1[,3:5] <- lapply(tableS1[,3:5],as.numeric)
kable(tableS1,digits=2)

```




**Table S2** Model selection table for analysis of factors affecting $\Delta$RTL in Seychelles warbler nestlings, using longitudinal data. Only models that remained in the top model set for model averaging (AICc $\leq$ 6 compared to the top model) are included here. TQ = territory quality.

```{r Table S2}

#Model averaging
t1 <- as.matrix(DeltaRTL_Full_Dredge)

#Sort out row/col names
nams <- colnames(t1)

nams[nams == 'z.GroupSize'] <- 'Group Size'
nams[nams == 'c.Sex'] <- 'Sex (males)'
nams[nams == 'c.Helper'] <- 'Helpers'
nams[nams == 'z.BodyMass'] <- 'Body mass'
nams[nams == 'z.LogAge'] <- 'Log age'
nams[nams == 'z.Tarsus'] <- 'Tarsus'
nams[nams == 'z.Insect'] <- 'Insect abundance'
nams[nams == 'z.CatchMonth'] <- 'Month'
nams[nams == 'z.Density'] <- 'Density'
nams[nams == 'z.TQ'] <- 'Territory quality'

colnames(t1) <- nams

tableS2 <- data.frame(Model = apply(t1,1,getterms,c(2:10)),t1[,c('df','AICc','delta','weight')],stringsAsFactors = FALSE)
colnames(tableS2) <- c('Model','df','AICc', 'Delta AICc','Weight')
rownames(tableS2) <- NULL
tableS2$Model[tableS2$Model == ''] <- 'Null model'
tableS2[,3:5] <- lapply(tableS2[,3:5],as.numeric)
kable(tableS2,digits=2)

```


**Figure S1** Model averaged estimates and 95% cofidence intervals for social and ecological environmental variables in relation to RTL in Seychelles warblers. 

```{r Figure S1}

#Model averaging
lmavg <- model.avg(RTL_Full_Dredge,fit=T)
myimp <- importance(lmavg) #Relative importance of each explanatory variable
  

#Put it all into a nice table
table2 <- imptable(lmavg,myimp)
table2 <- signif(table2,2)


#Sort out row/col names
nams <- rownames(table2)
nams[nams == 'z.GroupSize'] <- 'Group Size'
nams[nams == 'c.Sex'] <- 'Sex (males)'
nams[nams == 'c.Helper'] <- 'Helpers'
nams[nams == 'z.BodyMass'] <- 'Body mass'
nams[nams == 'z.LogAge'] <- 'Log age'
nams[nams == 'z.Tarsus'] <- 'Tarsus'
nams[nams == 'z.Insect'] <- 'Insect abundance'
nams[nams == 'z.CatchMonth'] <- 'Month'
nams[nams == 'z.Density'] <- 'Density'
nams[nams == 'z.TQ'] <- 'Territory quality'

rownames(table2) <- nams
colnames(table2) <- c('Estimate','SE','2.5%','97.5%','RI')


table2 <- data.frame(table2,myx=row.names(table2))
table2$myx <- factor(table2$myx,levels = table2$myx[order(table2$Estimate,decreasing = T)])

FigS1 <- forestplot(table2)+
  theme(axis.line.x = element_line(colour = 'black'),
        axis.line.y = element_line(colour = 'black'))

FigS1


```




**Figure S2** Model averaged estimates and 95% cofidence intervals for social and ecological environmental variables in relation to $\Delta$RTL in Seychelles warblers, using longitudinal data. 

```{r Figure S2}

#Model averaging
lmavg <- model.avg(DeltaRTL_Full_Dredge,fit=T)
myimp <- importance(lmavg) #Relative importance of each explanatory variable
  

#Put it all into a table
table2 <- imptable(lmavg,myimp)
table2 <- signif(table2,2)


#Sort out row/col names
nams <- rownames(table2)
nams[nams == 'z.GroupSize'] <- 'Group Size'
nams[nams == 'c.Sex'] <- 'Sex (males)'
nams[nams == 'c.Helper'] <- 'Helpers'
nams[nams == 'z.BodyMass'] <- 'Body mass'
nams[nams == 'z.LogAge'] <- 'Log age'
nams[nams == 'z.Tarsus'] <- 'Tarsus'
nams[nams == 'z.Insect'] <- 'Insect abundance'
nams[nams == 'z.CatchMonth'] <- 'Month'
nams[nams == 'z.Density'] <- 'Density'
nams[nams == 'z.TQ'] <- 'Territory quality'

rownames(table2) <- nams
colnames(table2) <- c('Estimate','SE','2.5%','97.5%','RI')

table2 <- data.frame(table2,myx=row.names(table2))
table2$myx <- factor(table2$myx,levels = table2$myx[order(table2$Estimate,decreasing = T)])

FigS2 <- forestplot(table2)+
  theme(axis.line.x = element_line(colour = 'black'),
        axis.line.y = element_line(colour = 'black'))

FigS2

```