---
output:
  word_document:
    reference_docx: myref.docx
---

###Supplementary information for Spurgin *et al.* "Telomeres reveal silver spoon effects in a wild population"





```{r setup, include = F}

rm(list=ls())

#Load knitr
library(knitr)

#Set some options
options(na.action='na.fail')
opts_knit$set(root.dir = '..')
opts_chunk$set(echo=FALSE,
               warning=FALSE,
               message=FALSE,
               fig.path='../Figures/',
               fig.width= 4,
               fig.height= 8,
               fig.show='asis',
               dev=c('png','pdf'))

```

```{r load and clean, include = F}

#Load and clean data
source('Scripts/SW juvenile telomeres IPC load.r')
source('Scripts/SW juvenile telomeres IPC functions.r')
source('Scripts/SW juvenile telomeres IPC clean.r')


```

**Table S1** Model selection table for analysis of factors affecting early life telomere length in juvenile Seychelles warblers. Only models that remained in the top model set for model averaging (AICc $\leq$ 6 compared to the top model) are included here. TQ = territory quality.

```{r Table S1}

#Run the model
lm1 <- lmer(RTL ~ Agemonths * (Tarsus + Helper + NonHelper + Sex + BodyMass  + TQ) + (1|FieldPeriodID)+(1|TerritoryID)+(1|PlateID),
            data = juv,
            REML = FALSE)
lm1 <- standardize(lm1)

#Model averaging
lm2 <- dredge(lm1)
t1 <- as.matrix(subset(lm2, delta<=6))

#Sort out row/col names
nams <- colnames(t1)

nams[nams == 'z.NonHelper'] <- 'Non helpers'
nams[nams == 'c.Sex'] <- 'Sex'
nams[nams == 'z.TQ'] <- 'TQ'
nams[nams == 'c.Helper'] <- 'Helpers'
nams[nams == 'z.BodyMass'] <- 'Body mass'
nams[nams == 'z.Agemonths'] <- 'Age'
nams[nams == 'z.Tarsus'] <- 'Tarsus'
nams[nams == 'c.Season'] <- 'Season'
nams[nams == 'c.Season:z.Agemonths'] <- 'Age x season'
nams[nams == 'z.Agemonths:z.NonHelper'] <- 'Age x non helpers'
nams[nams == 'c.Sex:z.Agemonths'] <- 'Age x sex'
nams[nams == 'z.Agemonths:z.TQ'] <- 'Age x TQ'
nams[nams == 'c.Helper:z.Agemonths'] <- 'Age x helpers'
nams[nams == 'z.Agemonths:z.BodyMass'] <- 'Age x mass'
nams[nams == 'z.Agemonths:z.Tarsus'] <- 'Age x tarsus'


colnames(t1) <- nams

tableS1 <- data.frame(Model = apply(t1,1,getterms,c(2:14)),t1[,c('df','AICc','delta','weight')],stringsAsFactors = FALSE)
colnames(tableS1) <- c('Model','df','AICc', 'Delta AICc','Weight')
rownames(tableS1) <- NULL
tableS1$Model[tableS1$Model == ''] <- 'Null model'
tableS1[,3:5] <- lapply(tableS1[,3:5],as.numeric)
kable(tableS1,digits=2)

```



**Table S2** Model selection table for analysis of factors affecting early life telomere loss in Seychelles warbler chicks, using longitudinal data. Only models that remained in the top model set for model averaging (AICc $\leq$ 6 compared to the top model) are included here. TQ = territory quality.

```{r Table S2}
temp <- subset(Loss,Agemonths == 1)

#Run the model
lm1 <- lmer(Loss ~ (Tarsus + Helper + NonHelper + Sex + BodyMass  + TQ) + (1|FieldPeriodID),
            data = temp,
            REML = FALSE)
lm1 <- standardize(lm1)

#Model averaging
lm2 <- dredge(lm1)
t1 <- as.matrix(subset(lm2, delta<=6))

#Sort out row/col names
nams <- colnames(t1)

nams[nams == 'z.RTL'] <- 'RTL'
nams[nams == 'z.NonHelper'] <- 'Non helpers'
nams[nams == 'c.Sex'] <- 'Sex'
nams[nams == 'z.TQ'] <- 'TQ'
nams[nams == 'c.Helper'] <- 'Helpers'
nams[nams == 'z.BodyMass'] <- 'Body mass'
nams[nams == 'z.Agemonths'] <- 'Age'
nams[nams == 'z.Tarsus'] <- 'Tarsus'
nams[nams == 'c.Season'] <- 'Season'
nams[nams == 'c.Season:z.Agemonths'] <- 'Age x season'
nams[nams == 'z.Agemonths:z.NonHelper'] <- 'Age x non helpers'
nams[nams == 'c.Sex:z.Agemonths'] <- 'Age x sex'
nams[nams == 'z.Agemonths:z.TQ'] <- 'Age x TQ'
nams[nams == 'c.Helper:z.Agemonths'] <- 'Age x helpers'
nams[nams == 'z.Agemonths:z.BodyMass'] <- 'Age x mass'
nams[nams == 'z.Agemonths:z.Tarsus'] <- 'Age x tarsus'


colnames(t1) <- nams

tableS2 <- data.frame(Model = apply(t1,1,getterms,c(2:7)),t1[,c('df','AICc','delta','weight')],stringsAsFactors = FALSE)
colnames(tableS2) <- c('Model','df','AICc', 'Delta AICc','Weight')
rownames(tableS2) <- NULL
tableS2$Model[tableS2$Model == ''] <- 'Null model'
tableS2[,3:5] <- lapply(tableS2[,3:5],as.numeric)
kable(tableS2,digits=2)

```
