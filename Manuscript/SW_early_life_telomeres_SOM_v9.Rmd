---
output: word_document
---

###Supplementary information for Spurgin *et al.* "Telomeres reveal complex silver spoon effects in a wild population"





```{r load and clean, include = F}

#Set wd one level up
setwd('..')


#Load and clean data

source('Scripts/SW juvenile telomeres IPC load.r')
source('Scripts/SW juvenile telomeres IPC functions.r')
source('Scripts/SW juvenile telomeres IPC clean.r')


#Set some options
options(na.action='na.fail')
opts_knit$set(root.dir = getwd())
opts_chunk$set(echo=FALSE,
               warning=FALSE,
               message=FALSE,
               fig.path='../Figures/',
               fig.width= 4,
               fig.height= 8,
               fig.show='asis',
               dev='png')

```


**Table S1** Model selection table for analysis of factors affecting early life telomere length in juvenile Seychelles warblers. Only models that remained in the top model set for model averaging (AICc $\leq$ 6 compared to the top model) are included here. i = intercept.

```{r Table S1}

#Run the model
lm1 <- lmer(TLKB ~ TQspace + Insect + GroupSize + Sex + Condition + Helper + (1|LayYear),
            data = FlSAall,REML=FALSE)

lm1 <- standardize(lm1)


#Model averaging
lm2 <- dredge(lm1)
t1 <- as.matrix(subset(lm2, delta<=6))
colnames(t1)[2:7] <- c('Sex', 'Body condition','Group size','Helper','Food av.','TQ')
getterms <- function(x)
  {
  temp <- c('i',names(which(!(is.na(x[2:7])))))
  return(paste(temp,collapse = " + "))
  }

tableS1 <- data.frame(Model = apply(t1,1,getterms),t1[,c('df','AICc','delta','weight')])
colnames(tableS1) <- c('Model','df','AICc', 'Delta AICc','Weight')
rownames(tableS1) <- NULL
tableS1$Model[tableS1$Model == ''] <- 'Null model'
kable(tableS1,digits=3)

```


PAGEBREAK

```{r Figure S1,fig.width=4,fig.height=4}


temp <- dd

ddFigS1 <- ddply(dd,
                 .(Age),
                 summarize,
                 TLKBmean = mean(TLKB),
                 TLKBse = se(TLKB))

ddFigS1 <- ddFigS1[complete.cases(ddFigS1),]
ddFigS1 <- subset(ddFigS1,Age<14)

FigS1 <- ggplot(ddFigS1,
       aes(x = Age,
           y = TLKBmean)) +
  geom_pointrange(aes(ymin=TLKBmean-TLKBse,ymax=TLKBmean+TLKBse)) +
  ylab('Telomere length (kb)') + 
  xlab('Age') + 
  theme_classic() +
  theme(axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14), 
        axis.title.y = element_text(size = 16,vjust=0.8),
        axis.title.x = element_text(size = 16))

FigS1

```


**Figure S1** Cross-sectional telomere length (mean $\pm$ s.e.) in relation to age in Seychelles warblers.

PAGEBREAK




















```{r Figure S2,fig.width=4,fig.height=4}


temp <- FlSA

ddFigS2 <- ddply(temp,
                 .(LayYear),
                 summarize,
                 TLKBmean = mean(TLKB),
                 TLKBse = se(TLKB))

ddFigS2 <- ddFigS2[complete.cases(ddFigS2),]
ddFigS2$LayYear <- as.numeric(paste(ddFigS2$LayYear))

FigS2 <- ggplot(ddFigS2,
       aes(x = LayYear,
           y = TLKBmean)) +
  geom_pointrange(aes(ymin=TLKBmean-TLKBse,ymax=TLKBmean+TLKBse)) +
  ylab('Telomere length (kb)') + 
  xlab('Lay Year') + 
  theme_classic() +
  theme(axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14), 
        axis.title.y = element_text(size = 16,vjust=0.8),
        axis.title.x = element_text(size = 16))

FigS2

```


**Figure S2** Cross-sectional juvenile telomere length (mean $\pm$ s.e.) across birth years in Seychelles warblers

PAGEBREAK




```{r Figure S3,fig.width=5}

temp <- subset(FlSA,LayYear %in% c(1999,2006,2007,2000))

FigS3A <- ggplot(temp,
      aes(x=GroupSize,
      y=TLKB,
      col=LayYear)) +
  stat_smooth(method=lm,fullrange=T,alpha=0.2, aes(fill=LayYear),lwd=1.2) + 
    ylab('Telomere length (kb)') + 
  xlab('Local Density') + 
  theme_classic() +
  theme(axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14), 
        axis.title.y = element_text(size = 16,vjust=0.8),
        axis.title.x = element_text(size = 16)) +
  scale_color_brewer(palette='Set1') + 
  scale_fill_brewer(palette='Set1') +
  annotate('text',x=2,y=10,label='A')


FigS3B <- ggplot(temp,
      aes(x=Condition,
      y=TLKB,
      col=LayYear)) +
  stat_smooth(method=lm,fullrange=T,alpha=0.2, aes(fill=LayYear),lwd=1.2) + 
    ylab('Telomere length (kb)') + 
  xlab('Body Condition') + 
  theme_classic() +
  theme(axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14), 
        axis.title.y = element_text(size = 16,vjust=0.8),
        axis.title.x = element_text(size = 16)) +
  scale_color_brewer(palette='Set1') + 
  scale_fill_brewer(palette='Set1') +
  annotate('text',x=-2,y=15,label='B')

multiplot(FigS3A,FigS3B)

```

**Figure S3** Within cohort relationships between telomere length and **A** local density and **B** body condition in juvenile Seychelles warblers. Only years with juvenile sample sizes >20 are included. Lines and shaded areas represent fitted values and 95% confidence limits from linear regressions.

